package com.hadooptest;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.FSDataInputStream;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.FileStatus;
import org.apache.hadoop.fs.Path;
import org.apache.log4j.BasicConfigurator;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.net.URI;
import java.net.URLEncoder;
import java.text.SimpleDateFormat;
import java.util.Date;

public class Look_up_file {         //查看文件
    public static void main( String[] args ) throws Exception {
        BasicConfigurator.configure();
        Configuration conf = new Configuration();
        //配置NameNode的地址
        URI uri = new URI("hdfs://192.168.20.130:8020");
        //指定用户名，获取FileSystem对象
        FileSystem fs = FileSystem.get(uri,conf,"hadoop");

        //指定路径
        Path path = new Path("/17034460218/input5_2/emp.csv");
        //获取文件状态
        FileStatus fileStatus = fs.getFileLinkStatus(path);
        //获取数据块的大小
        long blockSize = fileStatus.getBlockSize();
        System.out.println("数据文件快的大小:" + blockSize);

        //获取文件的大小
        long fileSize = fileStatus.getLen();
        System.out.println("文件大小：" + fileSize);

        //获取文件拥有着
        String fileOwner  = fileStatus.getOwner();
        System.out.println("文件所有者:" + fileOwner);

        //获取最近访问时间
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-mm-dd hh:mm:ss");
        long accessTime = fileStatus.getAccessTime();
        System.out.println("最近访问时间:" + accessTime);

        //获取最后修改时间
        long modifyTime = fileStatus.getModificationTime();
        System.out.println("最后修改时间:" + modifyTime);

        //文件内容
        String line = null;
        FSDataInputStream in = fs.open(path);
        BufferedReader d = new BufferedReader(new InputStreamReader(in));
        while ((line = d.readLine()) != null){
            System.out.println(line);
//            System.out.println(URLEncoder.encode(line,"utf-8"));
//            String[] strarray = line.split(" ");
//            for(int i = 0; i < strarray.length;i++){
//                System.out.print(strarray[i]);
//                System.out.print(" ");
//            }
        }
        fs.close();
    }
}
